# Session 기반, Token 기반 인증

### Session 기반 인증

- 세션 기반 인증을 위해 Session 과 Cookie 가 사용된다.

#### 절차

- 유저가 로그인을 한다.
- 서버는 로그인 request가 들어오면 사용자를 검증하고 유효할 경우 고유한 Session ID 값을 부여하여 세션 저장소에 저장한다.
- 검증 과정을 거치고 Session ID를 response header에 포함시켜 반환한다.
- 유저가 서버에서 받은 Session ID를 받아 쿠키에 저장한 후 인증이 필요한 Request에 접근할 때 마다 쿠키를 Request header에 포함시켜 보낸다.
- 서버에서는 쿠키를 받아 세션 저장소에서 검증한 후 요청에 해당하는 데이터를 반환한다.

#### 장점

- 구현이 명확하다.

- 쿠키를 통해 세션에 접근하면 세션 ID로 사용자를 구분하므로 매번 사용자 정보를 확인할 필요가 없다.

- 상대적으로 안전하다. 

  > 서버측에서 관리하기 때문에 클라이언트 변조에 영향을 받거나 데이터의 손상 우려가 적다.

#### 단점

- 서버가 세션 정보를 메모리에 가지고 있어야 한다.

  > 사용자 수가 많아질 수록 서버에 부담이 늘어난다.

  



### Token 기반 인증

- 세션 기반 인증과는 다르게 서버가 사인한 토큰을 이용하여 인증을 수행하는 방식.
- Token 기반 인증 방식과 Session 기반 인증 방식의 가장 큰 차이점은 유저의 정보가 서버에 저장되지 않는다는 점.
- Token 기반 인증의 방법으로 많은 웹 서버들은 JWT(JSON Web Token) 을 사용.

#### 절차

- 유저가 로그인을 한다.
- 서버는 request가 들어오면 사용자를 검증하고 유효할 경우 정상발급된 토큰임을 증명하는 signature를 갖는 토큰을 반환
- 클라이언트는 토큰을 저장하고 서버 요청 시 해당 토큰을 Request header에 담아 서버에 전달
- 서버는 토큰을 검증한 후 요청에 응답.

#### 장점

- 클라이언트에 토큰을 저장하므로 서버 메모리에 부담이 되지 않음.

- Stateless 서버로 상태를 유지하지 않음으로 클라이언트의 요청으로만 작업을 처리.

- 플랫폼간 권한을 공유할 수 있다.

  > Ex) OAuth : 페이스북/구글 같은 소셜 계정등을 이용해 다른 웹서비스에서도 이용가능.

#### 단점

- 손상의 위험이 크다.

- Token 값이 Session ID 보다 길다.

- 토큰을 강제로 만료시킬 수 없다.

  > 공격자에게 탈취되었을 때 토큰 만료시 까지 서버에 요청 가능.
  >
  > 만료 주기를 짧게 할 시 수시 로그인이 필요하여 사용자가 불편하고, 편의를 위해 주기를 길게 하면 탈취당하였을 때 피해가 커지게 된다.
  >
  > 이를 보완하기 위해 리프레시 토큰과 액세스 토큰으로 나누어 사용하는 방식을 택한다.







> 참고
>
> https://jins-dev.tistory.com/entry/Session-%EA%B8%B0%EB%B0%98-%EC%9D%B8%EC%A6%9D%EA%B3%BC-Token-%EA%B8%B0%EB%B0%98-%EC%9D%B8%EC%A6%9D
>
> https://dooopark.tistory.com/6
>
> https://tansfil.tistory.com/58
>
> https://artoria.us/25
>
> https://swalloow.github.io/implement-jwt
>
> https://sanghaklee.tistory.com/47

